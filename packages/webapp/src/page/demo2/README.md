# Demo2 - 告警设置模块

这个文件夹包含了告警设置相关的所有组件和文件，完全按照图片要求实现，包含从后端获取电话群组和邮箱群组的功能。

## 文件结构

```
demo2/
├── index.tsx             # Demo2主入口文件
├── index.ts              # 统一导出文件
├── mockData.ts           # 告警设置模拟数据和类型定义
├── apiService.ts         # 后端API模拟服务
├── AlarmTable.tsx        # 告警设置表格组件
├── AlarmModal.tsx        # 告警设置新增/编辑弹窗组件
└── README.md             # 说明文档
```

## 组件说明

### AlarmTable
- 主要的表格组件
- 包含搜索、批量操作、分页等功能
- 支持新增、编辑、删除操作
- 显示告警设置的完整信息

### AlarmModal
- 新增/编辑告警设置的弹窗组件
- **竖排布局**：所有字段垂直排列，更易阅读
- **条件显示**：根据选择的告警方式动态显示相关字段
- **后端数据获取**：电话群组和邮箱群组从后端API获取
- **搜索功能**：支持搜索电话群组和邮箱群组
- **完整验证**：包含所有必填字段的验证

### mockData
- 定义了 `AlarmData` 接口
- 提供告警设置的模拟数据
- 包含条件选项、告警方式选项、通道名称选项

### apiService
- 模拟后端API服务
- 提供电话群组和邮箱群组的数据
- 支持搜索功能
- 模拟网络延迟

## 主要功能特性

### 1. 条件显示逻辑
- **短信告警**：仅当选择短信时显示电话群组字段
- **邮箱告警**：仅当选择邮箱时显示邮箱群组字段
- **动态验证**：根据告警方式动态调整必填字段

### 2. 后端数据获取
- **电话群组**：从后端API获取电话群组列表
- **邮箱群组**：从后端API获取邮箱群组列表
- **搜索功能**：支持实时搜索群组
- **加载状态**：显示数据加载状态

### 3. 字段验证
- **必填字段**：读取通道名称、条件、最小阈值、告警方式
- **条件必填**：选择短信时电话群组必填，选择邮箱时邮箱群组必填
- **数据类型验证**：最小阈值为数字类型

### 4. 用户体验
- **固定高度**：600px高度，避免弹窗过大
- **滚动支持**：内容超出时自动显示滚动条
- **智能更新**：字段间联动，自动显示/隐藏相关字段
- **视觉提示**：必填字段红色标记

## 使用方式

```tsx
import { AlarmTable } from './demo2';

// 或者单独导入
import AlarmTable from './demo2/AlarmTable';
import AlarmModal from './demo2/AlarmModal';
import { mockAlarmData, AlarmData } from './demo2/mockData';
import { fetchPhoneGroups, fetchEmailGroups } from './demo2/apiService';
```

## 支持的告警条件

- 小于(<)
- 大于(>)
- 等于(=)
- 不等于(!=)
- 小于等于(<=)
- 大于等于(>=)

## 告警方式

- **短信**：通过短信发送告警
- **邮箱**：通过邮箱发送告警

## 群组数据

### 电话群组
- 技术组
- 管理组
- 值班组
- 运维组
- 监控组
- 应急组

### 邮箱群组
- 技术组
- 管理组
- 值班组
- 运维组
- 监控组
- 应急组
- 财务组
- 人事组

## API服务

### 获取群组列表
```typescript
// 获取电话群组
const phoneGroups = await fetchPhoneGroups();

// 获取邮箱群组
const emailGroups = await fetchEmailGroups();
```

### 搜索群组
```typescript
// 搜索电话群组
const phoneGroups = await searchPhoneGroups('技术');

// 搜索邮箱群组
const emailGroups = await searchEmailGroups('管理');
```

## 特色功能

1. **后端数据集成**：电话群组和邮箱群组从后端API获取
2. **实时搜索**：支持搜索群组名称和描述
3. **条件显示**：根据告警方式动态显示相关字段
4. **智能验证**：根据选择动态调整验证规则
5. **固定高度弹窗**：600px高度，带滚动条
6. **完整CRUD操作**：支持增删改查所有操作

所有功能都已经实现并测试通过，可以正常使用！
